bh_t %>% ggplot(aes(x = as.numeric(year),y = log(value+1))) + geom_point() + geom_smooth(method = "lm")+
facet_wrap(~study_village, scales = "fixed") +
theme_light()+ stat_poly_line() +
geom_smooth(method = "lm", color="black", fill="lightgrey")+
stat_pvalue_manual(
stat.test, bracket.nudge.y = -2, hide.ns = TRUE,
label = "{p.adj}{p.adj.signif}" ) +
ylab("# Beehives")+xlab("Year")+
theme(axis.text.y = element_text(size = 14))+ theme(axis.title = element_text(size = 14)) +
theme(axis.text.x = element_text(size = 14, angle=90))+ theme(axis.title = element_text(size = 14))+
theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank(),
strip.background = element_blank(),panel.border = element_rect(colour = "black"))+
theme(strip.text.x = element_text(size = 14, color = "black"))+
theme(strip.background = element_rect(color="grey0", fill="grey95", linetype="solid"))+
stat_cor(label.y=0))
bh_t %>% ggplot(aes(x = as.numeric(year),y = log(value+1))) + geom_point() + geom_smooth(method = "lm")+
facet_wrap(~study_village, scales = "fixed") +
theme_light()+ stat_poly_line() +
geom_smooth(method = "lm", color="black", fill="lightgrey")+
stat_pvalue_manual(
stat.test, bracket.nudge.y = -2, hide.ns = TRUE,
label = "{p.adj}{p.adj.signif}" ) +
ylab("# Beehives")+xlab("Year")+
theme(axis.text.y = element_text(size = 14))+ theme(axis.title = element_text(size = 14)) +
theme(axis.text.x = element_text(size = 14, angle=90))+ theme(axis.title = element_text(size = 14))+
theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank(),
strip.background = element_blank(),panel.border = element_rect(colour = "black"))+
theme(strip.text.x = element_text(size = 14, color = "black"))+
theme(strip.background = element_rect(color="grey0", fill="grey95", linetype="solid"))+
stat_cor(label.y=0))
bh_t %>% ggplot(aes(x = as.numeric(year),y = log(value+1))) + geom_point() + geom_smooth(method = "lm")+
facet_wrap(~study_village, scales = "fixed") +
theme_light()+ stat_poly_line() +
geom_smooth(method = "lm", color="black", fill="lightgrey")+
ylab("# Beehives")+xlab("Year")+
theme(axis.text.y = element_text(size = 14))+ theme(axis.title = element_text(size = 14)) +
theme(axis.text.x = element_text(size = 14, angle=90))+ theme(axis.title = element_text(size = 14))+
theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank(),
strip.background = element_blank(),panel.border = element_rect(colour = "black"))+
theme(strip.text.x = element_text(size = 14, color = "black"))+
theme(strip.background = element_rect(color="grey0", fill="grey95", linetype="solid"))+
bh_t %>% ggplot(aes(x = as.numeric(year),y = log(value+1))) + geom_point() +
facet_wrap(~study_village, scales = "fixed") +
theme_light()+ stat_poly_line() +
geom_smooth(method = "lm", color="black", fill="lightgrey")+
ylab("# Beehives")+xlab("Year")+
theme(axis.text.y = element_text(size = 14))+ theme(axis.title = element_text(size = 14)) +
theme(axis.text.x = element_text(size = 14, angle=90))+ theme(axis.title = element_text(size = 14))+
theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank(),
strip.background = element_blank(),panel.border = element_rect(colour = "black"))+
theme(strip.text.x = element_text(size = 14, color = "black"))+
theme(strip.background = element_rect(color="grey0", fill="grey95", linetype="solid"))+
bh_t %>% ggplot(aes(x = as.numeric(year),y = log(value+1))) + geom_point() +
facet_wrap(~study_village, scales = "fixed") +
theme_light()+ stat_poly_line() +
geom_smooth(method = "lm", color="black", fill="lightgrey")+
ylab("# Beehives")+xlab("Year")+
theme(axis.text.y = element_text(size = 14))+ theme(axis.title = element_text(size = 14)) +
theme(axis.text.x = element_text(size = 14, angle=90))+ theme(axis.title = element_text(size = 14))+
theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank(),
strip.background = element_blank(),panel.border = element_rect(colour = "black"))+
theme(strip.text.x = element_text(size = 14, color = "black"))+
theme(strip.background = element_rect(color="grey0", fill="grey95", linetype="solid"))
bh_t %>% ggplot(aes(x = as.numeric(year),y = log(value+1))) + geom_point() + geom_smooth(method = "lm", color="black", fill="lightgrey")+
facet_wrap(~study_village, scales = "fixed") +
theme_light()+
ylab("# Beehives")+xlab("Year")+
theme(axis.text.y = element_text(size = 14))+ theme(axis.title = element_text(size = 14)) +
theme(axis.text.x = element_text(size = 14, angle=90))+ theme(axis.title = element_text(size = 14))+
theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank(),
strip.background = element_blank(),panel.border = element_rect(colour = "black"))+
theme(strip.text.x = element_text(size = 14, color = "black"))+
theme(strip.background = element_rect(color="grey0", fill="grey95", linetype="solid"))
bh_t
bh_t %>% ggplot(aes(x = as.numeric(year),y = log(value+1), colour=study_village, fill=study_village)) + geom_point() + geom_smooth(method = "lm", color="black", fill="lightgrey")+
facet_wrap(~study_village, scales = "fixed") +
theme_light()+ ylab("# Beehives")+xlab("Year")+
theme(axis.text.y = element_text(size = 14))+ theme(axis.title = element_text(size = 14)) +
theme(axis.text.x = element_text(size = 14, angle=90))+ theme(axis.title = element_text(size = 14))+
theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank(),
strip.background = element_blank(),panel.border = element_rect(colour = "black"))+
theme(strip.text.x = element_text(size = 14, color = "black"))+
theme(strip.background = element_rect(color="grey0", fill="grey95", linetype="solid"))
bh_t %>% ggplot(aes(x = as.numeric(year),y = log(value+1), colour=study_village, fill=study_village)) + geom_point() + geom_smooth(method = "lm", color=study_village, fill="lightgrey")+
facet_wrap(~study_village, scales = "fixed") +
theme_light()+ ylab("# Beehives")+xlab("Year")+
theme(axis.text.y = element_text(size = 14))+ theme(axis.title = element_text(size = 14)) +
theme(axis.text.x = element_text(size = 14, angle=90))+ theme(axis.title = element_text(size = 14))+
theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank(),
strip.background = element_blank(),panel.border = element_rect(colour = "black"))+
theme(strip.text.x = element_text(size = 14, color = "black"))+
theme(strip.background = element_rect(color="grey0", fill="grey95", linetype="solid"))
bh_t %>% ggplot(aes(x = as.numeric(year),y = log(value+1), colour=study_village, fill=study_village)) + geom_point() +
geom_smooth(method = "lm", color="black", fill="lightgrey")+ stat_cor()+
facet_wrap(~study_village, scales = "fixed") +
theme_light()+ ylab("# Beehives")+xlab("Year")+
theme(axis.text.y = element_text(size = 14))+ theme(axis.title = element_text(size = 14)) +
theme(axis.text.x = element_text(size = 14, angle=90))+ theme(axis.title = element_text(size = 14))+
theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank(),
strip.background = element_blank(),panel.border = element_rect(colour = "black"))+
theme(strip.text.x = element_text(size = 14, color = "black"))+
theme(strip.background = element_rect(color="grey0", fill="grey95", linetype="solid"))
bh_t %>% ggplot(aes(x = as.numeric(year),y = log(value+1), colour=study_village, fill=study_village)) + geom_point() +
geom_smooth(method = "lm", color="black", fill="lightgrey")+ stat_cor(label.y = c(4,4,4,4,4,4,4,4,4,4))+
facet_wrap(~study_village, scales = "fixed") +
theme_light()+ ylab("# Beehives")+xlab("Year")+
theme(axis.text.y = element_text(size = 14))+ theme(axis.title = element_text(size = 14)) +
theme(axis.text.x = element_text(size = 14, angle=90))+ theme(axis.title = element_text(size = 14))+
theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank(),
strip.background = element_blank(),panel.border = element_rect(colour = "black"))+
theme(strip.text.x = element_text(size = 14, color = "black"))+
theme(strip.background = element_rect(color="grey0", fill="grey95", linetype="solid"))
bh_t %>% ggplot(aes(x = as.numeric(year),y = log(value+1)) + geom_point() +
geom_smooth(method = "lm", color="black", fill="lightgrey")+ stat_cor(label.y = c(4,4,4,4,4,4,4,4,4,4), col="black")+
facet_wrap(~study_village, scales = "fixed") +
theme_light()+ ylab("# Beehives")+xlab("Year")+
theme(axis.text.y = element_text(size = 14))+ theme(axis.title = element_text(size = 14)) +
theme(axis.text.x = element_text(size = 14, angle=90))+ theme(axis.title = element_text(size = 14))+
theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank(),
strip.background = element_blank(),panel.border = element_rect(colour = "black"))+
theme(strip.text.x = element_text(size = 14, color = "black"))+
theme(strip.background = element_rect(color="grey0", fill="grey95", linetype="solid"))
bh_t %>% ggplot(aes(x = as.numeric(year),y = log(value+1))) + geom_point() +
bh_t %>% ggplot(aes(x = as.numeric(year),y = log(value+1), colour=study_village, fill=study_village)) + geom_point() +
geom_smooth(method = "lm", color="black", fill="lightgrey")+ stat_cor(label.y = c(4,4,4,4,4,4,4,4,4,4), col="black")+
facet_wrap(~study_village, scales = "fixed") +
theme_light()+ ylab("# Beehives")+xlab("Year")+
theme(axis.text.y = element_text(size = 14))+ theme(axis.title = element_text(size = 14)) +
theme(axis.text.x = element_text(size = 14, angle=90))+ theme(axis.title = element_text(size = 14))+
theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank(),
strip.background = element_blank(),panel.border = element_rect(colour = "black"))+
theme(strip.text.x = element_text(size = 14, color = "black"))+
theme(strip.background = element_rect(color="grey0", fill="grey95", linetype="solid"))
bh_t %>% ggplot(aes(x = as.numeric(year),y = log(value+1), colour=study_village, fill=study_village)) + geom_point() +
geom_smooth(method = "lm", color="black", fill="lightgrey")+ stat_cor(label.y = c(4.2,4,4,4,4,4,4,4,4,4), col="black")+
facet_wrap(~study_village, scales = "fixed") +
theme_light()+ ylab("# Beehives")+xlab("Year")+
theme(axis.text.y = element_text(size = 14))+ theme(axis.title = element_text(size = 14)) +
theme(axis.text.x = element_text(size = 14, angle=90))+ theme(axis.title = element_text(size = 14))+
theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank(),
strip.background = element_blank(),panel.border = element_rect(colour = "black"))+
theme(strip.text.x = element_text(size = 14, color = "black"))+
theme(strip.background = element_rect(color="grey0", fill="grey95", linetype="solid"))
bh_t %>% ggplot(aes(x = as.numeric(year),y = log(value+1), colour=study_village, fill=study_village)) + geom_point(alpha=0.3) +
geom_smooth(method = "lm", color="black", fill="lightgrey")+ stat_cor(label.y = c(4.2,4.2,4.2,4.2,4.2,4.2,4.2,4.2,4.2,4.2), col="black")+
facet_wrap(~study_village, scales = "fixed") +
theme_light()+ ylab("# Beehives")+xlab("Year")+
theme(axis.text.y = element_text(size = 14))+ theme(axis.title = element_text(size = 14)) +
theme(axis.text.x = element_text(size = 14, angle=90))+ theme(axis.title = element_text(size = 14))+
theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank(),
strip.background = element_blank(),panel.border = element_rect(colour = "black"))+
theme(strip.text.x = element_text(size = 14, color = "black"))+
theme(strip.background = element_rect(color="grey0", fill="grey95", linetype="solid"))
bh_t %>% ggplot(aes(x = as.numeric(year),y = log(value+1), colour=study_village, fill=study_village)) + geom_point(alpha=0.5) +
geom_smooth(method = "lm", color="black", fill="lightgrey")+ stat_cor(label.y = c(4.2,4.2,4.2,4.2,4.2,4.2,4.2,4.2,4.2,4.2), col="black")+
facet_wrap(~study_village, scales = "fixed") +
theme_light()+ ylab("# Beehives")+xlab("Year")+
theme(axis.text.y = element_text(size = 14))+ theme(axis.title = element_text(size = 14)) +
theme(axis.text.x = element_text(size = 14, angle=90))+ theme(axis.title = element_text(size = 14))+
theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank(),
strip.background = element_blank(),panel.border = element_rect(colour = "black"))+
theme(strip.text.x = element_text(size = 14, color = "black"))+
theme(strip.background = element_rect(color="grey0", fill="grey95", linetype="solid"))
bh_t %>% ggplot(aes(x = as.numeric(year),y = log(value+1), colour=study_village, fill=study_village)) + geom_point(alpha=0.5) +
geom_smooth(method = "lm", color="black", fill="lightgrey")+ stat_cor(label.y = c(4.2,4.2,4.2,4.2,4.2,4.2,4.2,4.2,4.2,4.2), col="black")+
facet_wrap(~study_village, scales = "fixed") +
theme_light()+ ylab("# Beehives")+xlab("Year")+
theme(axis.text.y = element_text(size = 14))+ theme(axis.title = element_text(size = 14)) +
theme(axis.text.x = element_text(size = 14, angle=90))+ theme(axis.title = element_text(size = 14))+
theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank(),
strip.background = element_blank(),panel.border = element_rect(colour = "black"))+
theme(strip.text.x = element_text(size = 14, color = "black"))+
theme(strip.background = element_rect(color="grey0", fill="grey95", linetype="solid"))+
theme(legend.position = "none")
bh_vill_plot<-bh_t %>% ggplot(aes(x = as.numeric(year),y = log(value+1), colour=study_village, fill=study_village)) + geom_point(alpha=0.5) +
geom_smooth(method = "lm", color="black", fill="lightgrey")+ stat_cor(label.y = c(4.2,4.2,4.2,4.2,4.2,4.2,4.2,4.2,4.2,4.2), col="black")+
facet_wrap(~study_village, scales = "fixed") +
theme_light()+ ylab("# Beehives")+xlab("Year")+
theme(axis.text.y = element_text(size = 14))+ theme(axis.title = element_text(size = 14)) +
theme(axis.text.x = element_text(size = 14, angle=90))+ theme(axis.title = element_text(size = 14))+
theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank(),
strip.background = element_blank(),panel.border = element_rect(colour = "black"))+
theme(strip.text.x = element_text(size = 14, color = "black"))+
theme(strip.background = element_rect(color="grey0", fill="grey95", linetype="solid"))+
theme(legend.position = "none")
ggsave(paste0(dirF, "beehive_decline_vill.png"),width=8, height = 10, units="in", dpi=600 )
bh_vill_plot<-bh_t %>% ggplot(aes(x = as.numeric(year),y = log(value+1), colour=study_village, fill=study_village)) + geom_point(col="black", alpha=0.5) +
geom_smooth(method = "lm", color="black", fill="lightgrey")+ stat_cor(label.y = c(4.2,4.2,4.2,4.2,4.2,4.2,4.2,4.2,4.2,4.2), col="black")+
facet_wrap(~study_village, scales = "fixed") +
theme_light()+ ylab("# Beehives")+xlab("Year")+
theme(axis.text.y = element_text(size = 14))+ theme(axis.title = element_text(size = 14)) +
theme(axis.text.x = element_text(size = 14, angle=90))+ theme(axis.title = element_text(size = 14))+
theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank(),
strip.background = element_blank(),panel.border = element_rect(colour = "black"))+
theme(strip.text.x = element_text(size = 14, color = "black"))+
theme(strip.background = element_rect(color="grey0", fill="grey95", linetype="solid"))+
theme(legend.position = "none")
bh_vill_plot
bh_vill_plot<-bh_t %>% ggplot(aes(x = as.numeric(year),y = log(value+1), colour=study_village, fill=study_village)) + geom_point(col="black", alpha=0.3) +
geom_smooth(method = "lm", color="black", fill="lightgrey")+ stat_cor(label.y = c(4.2,4.2,4.2,4.2,4.2,4.2,4.2,4.2,4.2,4.2), col="black")+
facet_wrap(~study_village, scales = "fixed") +
theme_light()+ ylab("# Beehives")+xlab("Year")+
theme(axis.text.y = element_text(size = 14))+ theme(axis.title = element_text(size = 14)) +
theme(axis.text.x = element_text(size = 14, angle=90))+ theme(axis.title = element_text(size = 14))+
theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank(),
strip.background = element_blank(),panel.border = element_rect(colour = "black"))+
theme(strip.text.x = element_text(size = 14, color = "black"))+
theme(strip.background = element_rect(color="grey0", fill="grey95", linetype="solid"))+
theme(legend.position = "none")
bh_vill_plot
ggsave(paste0(dirF, "beehive_decline_vill.png"),width=8, height = 10, units="in", dpi=600 )
ggsave(paste0(dirF, "beehive_decline_vill.png"),width=8, height = 10, units="in", dpi=600 )
hy_plot_vill
hy_plot_vill<- hy_t %>% ggplot(aes(x = as.numeric(year),y = log(value+1))) + geom_point(col="black", alpha=0.3) + geom_smooth(method = "lm")+
stat_cor(label.y = c(3.2,3.2,3.2,3.2,3.2,3.2,3.2,3.2,3.2,3.2), col="black")
facet_wrap(~study_village, scales = "fixed") +  theme_bw()+
xlim(2009,2021)+
theme_light()+stat_compare_means(method = "anova", label.y = 7)+ ylab("Honey yield per hive")+ xlab("year")+
geom_smooth(method = "lm", color="black", fill="lightgrey")+
theme(axis.text.y = element_text(size = 14))+ theme(axis.title = element_text(size = 14)) +
theme(axis.text.x = element_text(size = 14, angle=90))+ theme(axis.title = element_text(size = 14))+
theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank(),
strip.background = element_blank(),panel.border = element_rect(colour = "black"))+
theme(strip.text.x = element_text(size = 14, color = "black"))+
theme(strip.background = element_rect(color="grey0", fill="grey95", linetype="solid"))
hy_plot_vill<- hy_t %>% ggplot(aes(x = as.numeric(year),y = log(value+1))) + geom_point(col="black", alpha=0.3) + geom_smooth(method = "lm")+
stat_cor(label.y = c(3.2,3.2,3.2,3.2,3.2,3.2,3.2,3.2,3.2,3.2), col="black")+
facet_wrap(~study_village, scales = "fixed") +  theme_bw()+
xlim(2009,2021)+
theme_light()+stat_compare_means(method = "anova", label.y = 7)+ ylab("Honey yield per hive")+ xlab("year")+
geom_smooth(method = "lm", color="black", fill="lightgrey")+
theme(axis.text.y = element_text(size = 14))+ theme(axis.title = element_text(size = 14)) +
theme(axis.text.x = element_text(size = 14, angle=90))+ theme(axis.title = element_text(size = 14))+
theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank(),
strip.background = element_blank(),panel.border = element_rect(colour = "black"))+
theme(strip.text.x = element_text(size = 14, color = "black"))+
theme(strip.background = element_rect(color="grey0", fill="grey95", linetype="solid"))
hy_plot_vill
ggsave(paste0(dirF, "honey_yield_per_village.png"),width=8, height = 10, units="in", dpi=600 )
read.table(honeybee_importance_percrop_pervillage.txt)
getwd()
read.table("../data/honeybee_importance_percrop_pervillage.txt")
data_bh_impotance<-read.table("../data/honeybee_importance_percrop_pervillage.txt")
data_bee_impotance<-read.table("../data/honeybee_importance_percrop_pervillage.txt")
data_bee_import<-read.table("../data/honeybee_importance_percrop_pervillage.txt")
bee_import<-read.table("../data/honeybee_importance_percrop_pervillage.txt")
bee_import
head(honeybee_importance_percrop_pervillage.txt)
head(bee_import)
bee_import<-read.table("../data/honeybee_importance_percrop_pervillage.txt", header=T)
head(bee_import)
dim(bee_import)
bee_import$Importance
bee_import$pollen_capacity
bee_import$vF
bee_import$vQ
bee_import$Crop
head(bee_import)
0.05200000*0.6190476*70.05556
bee_import$Village
bee_import$Village$"CHAU"
bee_import$Villag
bee_import$Village
bee_import$Village[1]
bee_import
head(bee_import)
id<-which(bee_import[,2]=="GADI")
bee_import[id,]
0.012195122*0.6000000
bee_import$Importance
range(bee_import$Importance)
head(bee_import)
0.06204380*0.7083333*106.89130
bee_import[id,]
sum(bee_import[id,]$vF)
sum(bee_import[id,]$vQ)
id.gadi<-which(bee_import[,2]=="GADI")
sum(bee_import[id.gadi,]$vQ)
head(bee_import)
id.pat<-which(bee_import[,2]=="PATM")
sum(bee_import[id.pat,]$vQ)
id.pat<-which(bee_import[,2]=="PATM")
bee_import[id.pat,]
ggplot(df %>% arrange(Importance) %>%
mutate(name=factor(name, levels=name[crop=="Crop"])),
aes(x = name, y = value, fill = crop)) +
geom_bar(stat = "identity", position=position_dodge())
ggplot(bee_import %>% arrange(Importance) %>%
mutate(name=factor(name, levels=name[crop=="Crop"])),
aes(x = name, y = value, fill = crop)) +
geom_bar(stat = "identity", position=position_dodge())
(bee_import %>% arrange(Importance)
bee_import %>% arrange(Importance)
bee_import
bee_import<-read.table("../data/honeybee_importance_percrop_pervillage.txt", header=T)
head(bee_import)
bee_import
bee_import %>% arrange(Village)
bee_import %>% arrange(Village, desc(Importance))
#arrange data by village and descending importance of plants for honeybees
bee_import %>% arrange(Village, desc(Importance)) %>% mutate(ranking = rank(Importance, ties.method = 'first'))
#arrange data by village and descending importance of plants for honeybees
bee_import %>% arrange(Village, desc(Importance)) %>%  mutate(rank = dense_rank(desc(importance))
)
#arrange data by village and descending importance of plants for honeybees
bee_import %>% arrange(Village, desc(Importance)) %>%  mutate(rank = dense_rank(desc(importance)))
bee_import<-read.table("../data/honeybee_importance_percrop_pervillage.txt", header=T)
#arrange data by village and descending importance of plants for honeybees
bee_import %>% arrange(Village, desc(Importance)) %>%  mutate(rank = dense_rank(desc(Importance)))
#arrange data by village and descending importance of plants for honeybees
bee_import %>% arrange(Village, desc(Importance)) %>% group_by(Village) %>%  mutate(rank = dense_rank(desc(Importance)))
#arrange data by village and descending importance of plants for honeybees
new_dat<-bee_import %>% arrange(Village, desc(Importance)) %>% group_by(Village) %>%  mutate(rank = dense_rank(desc(Importance)))
new_dat
View(new_dat)
View(new_dat)
ggplot(new_dat, aes(x=Importance, y=Crop)) +
facet_wrap(~study_village)+
geom_bar(stat="identity", width=.5, fill="tomato3") +
theme(axis.text.x = element_text(angle=65, vjust=0.6))
ggplot(new_dat, aes(x=Importance, y=Crop)) +
facet_wrap(~Village)+
geom_bar(stat="identity", width=.5, fill="tomato3") +
theme(axis.text.x = element_text(angle=65, vjust=0.6))
desc(Importance)
#arrange data by village and descending importance of plants for honeybees
new_dat<-bee_import %>% arrange(Village, desc(Importance)) %>% group_by(Village) %>%  mutate(rank = dense_rank(desc(Importance)>5))
new_dat
#arrange data by village and descending importance of plants for honeybees
new_dat<-bee_import %>% arrange(Village, desc(Importance)) %>% group_by(Village) %>%  mutate(rank = dense_rank(desc(Importance))>5)
new_dat
#arrange data by village and descending importance of plants for honeybees
new_dat<-bee_import %>% arrange(Village, desc(Importance)) %>% group_by(Village) %>%  mutate(rank = dense_rank(desc(Importance))<5)
new_dat
#arrange data by village and descending importance of plants for honeybees
new_dat<-bee_import %>% arrange(Village, desc(Importance)) %>% group_by(Village) %>%  mutate(rank = dense_rank(desc(Importance))<6)
#arrange data by village and descending importance of plants for honeybees
new_dat<-bee_import %>% arrange(Village, desc(Importance)) %>% group_by(Village) %>%  mutate(rank = dense_rank(desc(Importance))<6)
new_dat
#arrange data by village and descending importance of plants for honeybees
new_dat<-bee_import %>% arrange(Village, desc(Importance)) %>% group_by(Village) %>%  mutate(rank = dense_rank(desc(Importance)))
new_dat %>% filter(rank<6)
bi_reorder_keep %>% filter(rank<6)
bi_reorder_keep <-bi_reorder %>% filter(rank<6)
#arrange data by village and descending importance of plants for honeybees
bi_reorder<-bee_import %>% arrange(Village, desc(Importance)) %>% group_by(Village) %>%  mutate(rank = dense_rank(desc(Importance)))
bi_reorder_keep <-bi_reorder %>% filter(rank<6)
bi_reorder_keep %>% summaerise(rank())
bi_reorder_keep %>% summaerise(n())
bi_reorder_keep %>% summarise(n())
bi_reorder_keep %>% summarise(rank=n())
bi_reorder_keep <-bi_reorder %>% filter(rank<6)
bi_reorder_keep
bi_reorder_keep %>% count(rank)
bi_reorder_keep %>% filter(Crop, rank)
bi_reorder_keep %>% filter(Crop, Village, rank)
bi_reorder_keep
bi_reorder_keep %>% group_by(Crop) %>% summarize(rank = n()
bi_reorder_keep %>% group_by(Crop) %>% summarize(rank = n())
bi_reorder_keep %>% group_by(Crop) %>% summarize(rank = n())
bi_reorder_keep[,c(1,7)]
table(bi_reorder_keep[,c(1,7)])
plot(table(bi_reorder_keep[,c(1,7)])
barplot(table(bi_reorder_keep[,c(1,7)])
plot(table(bi_reorder_keep[,c(1,7)]
table(bi_reorder_keep[,c(1,7)
table(bi_reorder_keep[,c(1,7)
table(bi_reorder_keep[,c(1,7)]
table(bi_reorder_keep[,c(1,7)])
table(bi_reorder_keep[,c(1,7)])[,1]
plot(table(bi_reorder_keep[,c(1,7)])[,1])
bi_reorder_keep %>% select(Crops:rank)
bi_reorder_keep
bi_reorder_keep %>% select(Crop:rank)
table(bi_reorder_keep[,c(1,7)])[,1]
table(bi_reorder_keep[,c(1,7)])[,1]>0
table(bi_reorder_keep[,c(1,7)])[,1]
plot(bi_reorder_keep %>% select(Crop:rank))
table(bi_reorder_keep[,c(1,7)])[,1]
table(bi_reorder_keep[,c(1,7)])[,1]
table(bi_reorder_keep[,c(1,7)])
bi_reorder_keep %>% group_by(Crop, rank) %>% summarize(rank = n())
bi_reorder_keep
bi_reorder_keep %>% group_by(Crop, rank) %>% summarize(rank = sum())
bi_reorder_keep %>% group_by(Crop, rank) %>% summarize(rank = n())
bi_reorder_keep %>% group_by(Crop, rank) %>% summarize(rank = n()) %>%   mutate(freq = n / sum(n))
bi_reorder_keep %>% group_by(Crop, rank) %>% summarize(rank = n())
a<-bi_reorder_keep %>% group_by(Crop, rank) %>% summarize(rank = n())
a
View(a)
bi_reorder_keep
View(a)
table(bi_reorder_keep[,c(1,7)])
#a<-bi_reorder_keep %>% group_by(Crop, rank) %>% summarize(rank = n())
table(bi_reorder_keep[,c(1,7)])
#a<-bi_reorder_keep %>% group_by(Crop, rank) %>% summarize(rank = n())
tab_rank<-table(bi_reorder_keep[,c(1,7)])
order(tab_rank[,1])
sort(tab_rank[,1])
order(tab_rank[,1])
tab_rank[,1]
tab_rank
tab_rank[order(tab_rank)]
tab_rank[order(tab_rank, decreasing = TRUE)]
tab_rank
tab_rank[,order(tab_rank, decreasing = TRUE)]
order(tab_rank, decreasing = TRUE)
tab_rank[,order(tab_rank[,1], decreasing = TRUE)]
tab_rank[order(tab_rank[,1], decreasing = TRUE)]
tab_rank[order(tab_rank[,1], decreasing = TRUE),]
heatmap(tab_rank[order(tab_rank[,1], decreasing = TRUE),])
x <- LETTERS[1:20]
y <- paste0("var", seq(1,20))
data <- expand.grid(X=x, Y=y)
data$Z <- runif(400, 0, 5)
data
pivot_longer(tab_rank[,],cols = c("1", "2", "3", "4", "5"), names_to = "rank")
#a<-bi_reorder_keep %>% group_by(Crop, rank) %>% summarize(rank = n())
tab_rank<-as.data.frame(table(bi_reorder_keep[,c(1,7)]))
pivot_longer(tab_rank[,],cols = c("1", "2", "3", "4", "5"), names_to = "rank")
tab_rank
#a<-bi_reorder_keep %>% group_by(Crop, rank) %>% summarize(rank = n())
tab_rank<-as.data.frame(table(bi_reorder_keep[,c(1,7)]))
tab_rank
library(viridis)
ggplot(tab_rank, aes(Crop, Rank, fill= Freq)) +
geom_tile() +
scale_fill_viridis(discrete=FALSE) +
theme_ipsum()
ggplot(tab_rank, aes(Crop, Rank, fill= Freq)) +
geom_tile() +
scale_fill_viridis(discrete=FALSE)
tab_rank
ggplot(tab_rank, aes(Crop, rank, fill= Freq)) +
geom_tile() +
scale_fill_viridis(discrete=FALSE)
tab_rank
tab_rank[order(tab_rank$Freq)]
tab_rank[order(tab_rank$Freq),]
tab_rank[order(tab_rank$Freq, decreasing = TRUE),]
tab_rank[order(tab_rank$rank, increasing = TRUE),]
tab_rank[order(tab_rank$rank, increasing = TRUE),]
tab_rank[order(tab_rank$rank,]
tab_rank[order(tab_rank$rank)]
tab_rank[order(tab_rank$rank),]
tab_rank[order(tab_rank$rank, decreasing=FALSE),]
temp<-tab_rank[order(tab_rank$rank, decreasing=FALSE),]
tab_rank2<-temp[order(temp$Freq, decreasing=FALSE),]
tab_rank2
#a<-bi_reorder_keep %>% group_by(Crop, rank) %>% summarize(rank = n())
tab_rank<-as.data.frame(table(bi_reorder_keep[,c(1,7)]))
temp<-tab_rank[order(tab_rank$rank, decreasing=FALSE),]
tab_rank2<-temp[order(temp$Freq, decreasing=TRUE),]
tab_rank2
temp
ggplot(tab_rank2, aes(Crop, rank, fill= Freq)) +
geom_tile() +
scale_fill_viridis(discrete=FALSE)
ggplot(tab_rank2, aes(rank, Crop, fill= Freq)) +
geom_tile() +
scale_fill_viridis(discrete=FALSE)
tab_rank2
tab_rank
tab_rank2<-tab_rank[order(tab_rank$rank, decreasing=FALSE),]
tab_rank2
tab_rank2 %>% group_by(rank) %>% mutate(order = dense_rank(asc(Freq)))
tab_rank
ggsave(paste0(dirF, "heatmap_importance.png"),width=8, height = 10, units="in", dpi=600 )
dataframe$n_nas <- ifelse(tab_rank2$Freq==0,NA,dataframe$n)
tab_rank2$Freq$n_nas <- ifelse(tab_rank2$Freq==0,NA, tab_rank2$Freq)
tab_rank2$Freq==0
tab_rank2$Freq$n_nas <- ifelse(tab_rank2$Freq==0, NA, tab_rank2$Freq)
tab_rank2$n_nas <- ifelse(tab_rank2$Freq==0, NA, tab_rank2$Freq)
tab_rank2$n_nas
ggplot(tab_rank2, aes(x=rank, y=Crop, fill=n_nas)) +
geom_tile(color="white", size = 0.25) +
geom_text(aes(label = n)) +
scale_fill_gradient(low="gold", high="darkorchid", na.value="white"))
ggplot(tab_rank2, aes(x=rank, y=Crop, fill=n_nas)) +
geom_tile(color="white", size = 0.25) +
geom_text(aes(label = n)) +
scale_fill_gradient(low="gold", high="darkorchid", na.value="white")
ggplot(tab_rank2, aes(x=rank, y=Crop, fill=n_nas)) +
geom_tile(color="white", size = 0.25) +
geom_text(aes(label = Freq)) +
scale_fill_gradient(low="gold", high="darkorchid", na.value="white")
ggsave(paste0(dirF, "heatmap_importance.png"),width=8, height = 10, units="in", dpi=600 )
tab_rank2
table(bi_reorder_keep[,c(1,7)])
#a<-bi_reorder_keep %>% group_by(Crop, rank) %>% summarize(rank = n())
t<-table(bi_reorder_keep[,c(1,7)])
order(t)[,1]
order(t)[1]
str(t)
rownames(t)
rownames(t)
t[order(t[,1]),]
t[order(t[,1], decreasing=FALSE),]
t[order(t[,1], decreasing=TRUE),]
t2<-t[order(t[,1], decreasing=TRUE),]
tab_rank<-as.data.frame(table(t2[,c(1,7)]))
tab_rank<-as.data.frame(t2)
tab_rank
tab_rank2<-tab_rank[order(tab_rank$rank, decreasing=FALSE),]
tab_rank2 %>% group_by(rank) %>% mutate(order = dense_rank(asc(Freq)))
tab_rank2$n_nas <- ifelse(tab_rank2$Freq==0, NA, tab_rank2$Freq)
ggplot(tab_rank2, aes(x=rank, y=Crop, fill=n_nas)) +
geom_tile(color="white", size = 0.25) +
geom_text(aes(label = Freq)) +
scale_fill_gradient(low="gold", high="darkorchid", na.value="white")
tab_rank2
ggsave(paste0(dirF, "heatmap_importance.png"),width=8, height = 10, units="in", dpi=600 )
