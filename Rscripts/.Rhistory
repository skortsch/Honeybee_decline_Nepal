apl$apple_yield_change
#### Apple decline question
apl
colnames(apl)
#### Apple decline question
apl$apple_yield_change
apl[which(apl$apple_yield_change =="decrease"), 4]<-1
apl[which(apl$apple_yield_change =="increase"), 4]<-2
apl[which(apl$apple_qual_change=="no_change"), 4]<-3
apl[which(apl$apple_qual_change=="dont_know"), 4]<-4
apl[which(is.na(apl$apple_yield_change)), 4]<-5
ggplot(apl, aes(x = apple_yield_change )) +
geom_bar(aes(y = (..count..)/sum(..count..)), fill="grey70")+ theme_bw() +
scale_y_continuous(labels=scales::percent) +
ylab("percentage")+ xlab("percieved apple yield change")+
geom_text(aes(label = scales::percent(..prop..), y= ..prop.. ), stat= "count", vjust = -.5, size=6)+
theme(axis.text.x=element_text(size=14))+
theme(text = element_text(size = 16))
#### Apple decline question
apl$apple_yield_change
apl[which(apl$apple_qual_change=="no_change"), 4]<-3
#### Apple decline question
apl$apple_yield_change
apl[which(apl$apple_yield_change =="decrease"), 4]<-1
apl[which(apl$apple_yield_change =="increase"), 4]<-2
apl[which(apl$apple_yield_change=="no_change"), 4]<-3
apl[which(apl$apple_yield_change=="dont_know"), 4]<-4
apl[which(is.na(apl$apple_yield_change)), 4]<-5
#### Apple decline question
apl$apple_yield_change
as.numeric(apl[which(apl$apple_yield_change =="decrease"), 4]<-1)
#### Apple decline question
apl$apple_yield_change
ggplot(apl, aes(x = as.numeric(apple_yield_change) )) +
geom_bar(aes(y = (..count..)/sum(..count..)), fill="grey70")+ theme_bw() +
scale_y_continuous(labels=scales::percent) +
ylab("percentage")+ xlab("percieved apple yield change")+
geom_text(aes(label = scales::percent(..prop..), y= ..prop.. ), stat= "count", vjust = -.5, size=6)+
theme(axis.text.x=element_text(size=14))+
theme(text = element_text(size = 16))
#### Apple decline question
apl$apple_yield_change
#### Apple decline question
#apple change
apl<-read.csv("../data/apple_change.csv", sep=";",check.names=FALSE)
colnames(apl)
apl
apl$apple_yield_change
#### Apple decline question
#apple change
apl<-read.csv("../data/apple_change.csv", sep=";",check.names=FALSE)
colnames(apl)
apl$apple_yield_change
#### Apple decline question
#apple change
apl<-read.csv("../data/apple_change.csv", sep=";",check.names=FALSE)
colnames(apl)
#this is the correct wd path
#C:\LocalData\susakort\field work Nepal\Rscripts
setwd("C:/LocalData/susakort/field work Nepal/Honeybee_decline_Nepal/Rscripts")
#### Apple decline question
#apple change
apl<-read.csv("../data/apple_change.csv", sep=";",check.names=FALSE)
colnames(apl)
apl
apl$apple_yield_change
ggplot(apl, aes(x = as.numeric(apple_yield_change) )) +
geom_bar(aes(y = (..count..)/sum(..count..)), fill="grey70")+ theme_bw() +
scale_y_continuous(labels=scales::percent) +
ylab("percentage")+ xlab("percieved apple yield change")+
geom_text(aes(label = scales::percent(..prop..), y= ..prop.. ), stat= "count", vjust = -.5, size=6)+
theme(axis.text.x=element_text(size=14))+
theme(text = element_text(size = 16)) +
scale_x_discrete(labels=c('decrease', 'increase', 'no change', 'do not know', "NAs"))
ggplot(apl, aes(x = as.numeric(apple_yield_change) )) +
geom_bar(aes(y = (..count..)/sum(..count..)), fill="grey70")+ theme_bw() +
scale_y_continuous(labels=scales::percent) +
ylab("percentage")+ xlab("percieved apple yield change")+
geom_text(aes(label = scales::percent(..prop..), y= ..prop.. ), stat= "count", vjust = -.5, size=6)+
theme(axis.text.x=element_text(size=14))+
theme(text = element_text(size = 16))
apl[which(apl$apple_yield_change =="decrease"), 4]<-1
apl[which(apl$apple_yield_change =="increase"), 4]<-2
apl[which(apl$apple_yield_change=="no_change"), 4]<-3
apl[which(apl$apple_yield_change=="dont_know"), 4]<-4
apl[which(is.na(apl$apple_yield_change)), 4]<-5
ggplot(apl, aes(x = as.numeric(apple_yield_change) )) +
geom_bar(aes(y = (..count..)/sum(..count..)), fill="grey70")+ theme_bw() +
scale_y_continuous(labels=scales::percent) +
ylab("percentage")+ xlab("percieved apple yield change")+
geom_text(aes(label = scales::percent(..prop..), y= ..prop.. ), stat= "count", vjust = -.5, size=6)+
theme(axis.text.x=element_text(size=14))+
theme(text = element_text(size = 16))
ggplot(apl, aes(x = as.numeric(apple_yield_change) )) +
geom_bar(aes(y = (..count..)/sum(..count..)), fill="grey70")+ theme_bw() +
scale_y_continuous(labels=scales::percent) +
ylab("percentage")+ xlab("percieved apple yield change")+
geom_text(aes(label = scales::percent(..prop..), y= ..prop.. ), stat= "count", vjust = -.5, size=6)+
theme(axis.text.x=element_text(size=14))+
theme(text = element_text(size = 16)) +
scale_x_discrete(labels=c('decrease', 'increase', 'no change', 'dont know', "NAs"))
ggplot(apl, aes(x = as.numeric(apple_yield_change) )) +
geom_bar(aes(y = (..count..)/sum(..count..)), fill="grey70")+ theme_bw() +
scale_y_continuous(labels=scales::percent) +
ylab("percentage")+ xlab("percieved apple yield change")+
geom_text(aes(label = scales::percent(..prop..), y= ..prop.. ), stat= "count", vjust = -.5, size=6)+
theme(axis.text.x=element_text(size=14))+
theme(text = element_text(size = 16)) +
scale_x_discrete(labels=c('decrease', 'increase', 'no change', 'dont know', "NAs"))
bp_labs<-c('decrease', 'increase', 'no change', 'dont know', "NAs")
ggplot(apl, aes(x = as.numeric(apple_yield_change) )) +
geom_bar(aes(y = (..count..)/sum(..count..)), fill="grey70")+ theme_bw() +
scale_y_continuous(labels=scales::percent) +
scale_x_discrete(labels=bp_labs)+
ylab("percentage")+ xlab("percieved apple yield change")+
geom_text(aes(label = scales::percent(..prop..), y= ..prop.. ), stat= "count", vjust = -.5, size=6)+
theme(axis.text.x=element_text(size=14))+
theme(text = element_text(size = 16))
ggplot(apl, aes(x = as.numeric(apple_yield_change) )) +
geom_bar(aes(y = (..count..)/sum(..count..)), fill="grey70")+ theme_bw() +
scale_y_continuous(labels=scales::percent) +
ylab("percentage")+ xlab("percieved apple yield change")+
geom_text(aes(label = scales::percent(..prop..), y= ..prop.. ), stat= "count", vjust = -.5, size=6)+
theme(axis.text.x=element_text(size=14))+
theme(text = element_text(size = 16))
ggplot(apl, aes(x = as.numeric(apple_yield_change) )) +
geom_bar(aes(y = (..count..)/sum(..count..)), fill="grey70")+ theme_bw() +
scale_y_continuous(labels=scales::percent) +
ylab("percentage")+ xlab("percieved apple yield change")+
geom_text(aes(label = scales::percent(..prop..), y= ..prop.. ), stat= "count", vjust = -.5, size=6)+
theme(axis.text.x=element_text(size=14))+
theme(text = element_text(size = 16)) +
scale_x_discrete(labels=bp_labs)
ggplot(apl, aes(x = as.numeric(apple_yield_change) )) +
geom_bar(aes(y = (..count..)/sum(..count..)), fill="grey70")+ theme_bw() +
scale_y_continuous(labels=scales::percent) +
geom_text(aes(label = scales::percent(..prop..), y= ..prop.. ), stat= "count", vjust = -.5, size=6)+
theme(axis.text.x=element_text(size=14))+
theme(text = element_text(size = 16)) +
scale_x_discrete(labels=bp_labs)+
ylab("percentage")+ xlab("percieved apple yield change")
bp_labs<-c('decrease', 'increase', 'no change', 'dont know', "NAs")
ggplot(apl, aes(x = as.numeric(apple_yield_change) )) +
geom_bar(aes(y = (..count..)/sum(..count..)), fill="grey70")+ theme_bw() +
scale_y_continuous(labels=scales::percent) +
geom_text(aes(label = scales::percent(..prop..), y= ..prop.. ), stat= "count", vjust = -.5, size=6)+
theme(axis.text.x=element_text(size=14))+
theme(text = element_text(size = 16)) +
scale_x_discrete(labels=bp_labs)+
ylab("percentage")
ggplot(apl, aes(x = as.numeric(apple_yield_change) )) +
geom_bar(aes(y = (..count..)/sum(..count..)), fill="grey70")+ theme_bw() +
scale_y_continuous(labels=scales::percent) +
geom_text(aes(label = scales::percent(..prop..), y= ..prop.. ), stat= "count", vjust = -.5, size=6)+
theme(axis.text.x=element_text(size=14))+
theme(text = element_text(size = 16)) +
scale_x_discrete(labels=bp_labs)+
ylab("percentage")+ xlab("percieved apple yield change")
ggplot(apl, aes(x = as.numeric(apple_yield_change) )) +
geom_bar(aes(y = (..count..)/sum(..count..)), fill="grey70")+ theme_bw() +
scale_y_continuous(labels=scales::percent) +
geom_text(aes(label = scales::percent(..prop..), y= ..prop.. ), stat= "count", vjust = -.5, size=6)+
theme(axis.text.x=element_text(size=14))+
theme(text = element_text(size = 16)) +
ylab("percentage")+ xlab("percieved apple yield change")
ggplot(apl, aes(x = as.numeric(apple_yield_change) )) +
geom_bar(aes(y = (..count..)/sum(..count..)), fill="grey70")+ theme_bw() +
scale_y_continuous(labels=scales::percent) +
geom_text(aes(label = scales::percent(..prop..), y= ..prop.. ), stat= "count", vjust = -.5, size=6)+
theme(axis.text.x=element_text(size=14))+
theme(text = element_text(size = 16)) +
ylab("percentage")+ xlab("percieved apple yield change")
scale_x_continuous(labels=bp_labs)
ggplot(apl, aes(x = as.numeric(apple_yield_change) )) +
geom_bar(aes(y = (..count..)/sum(..count..)), fill="grey70")+ theme_bw() +
scale_y_continuous(labels=scales::percent) +
geom_text(aes(label = scales::percent(..prop..), y= ..prop.. ), stat= "count", vjust = -.5, size=6)+
theme(axis.text.x=element_text(size=14))+
theme(text = element_text(size = 16)) +
ylab("percentage")+ xlab("percieved apple yield change")+
scale_x_discrete(labels=bp_labs)
ggplot(apl, aes(x = as.numeric(apple_yield_change) )) +
geom_bar(aes(y = (..count..)/sum(..count..)), fill="grey70")+ theme_bw() +
scale_y_continuous(labels=scales::percent) +
geom_text(aes(label = scales::percent(..prop..), y= ..prop.. ), stat= "count", vjust = -.5, size=6)+
theme(axis.text.x=element_text(size=14))+
theme(text = element_text(size = 16)) +
ylab("percentage")+ xlab("percieved apple yield change")
ggplot(apl, aes(x = as.numeric(apple_yield_change) )) +
geom_bar(aes(y = (..count..)/sum(..count..)), fill=c("grey20", "grey40", "grey60", "grey80", "grey100"))+ theme_bw() +
scale_y_continuous(labels=scales::percent) +
geom_text(aes(label = scales::percent(..prop..), y= ..prop.. ), stat= "count", vjust = -.5, size=6)+
theme(axis.text.x=element_text(size=14))+
theme(text = element_text(size = 16)) +
ylab("percentage")+ xlab("percieved apple yield change")+
scale_x_discrete(labels=bp_labs)
ggplot(apl, aes(x = as.numeric(apple_yield_change) )) +
geom_bar(aes(y = (..count..)/sum(..count..)), fill=c("grey20", "grey40", "grey50", "grey70", "grey90"))+ theme_bw() +
scale_y_continuous(labels=scales::percent) +
geom_text(aes(label = scales::percent(..prop..), y= ..prop.. ), stat= "count", vjust = -.5, size=6)+
theme(axis.text.x=element_text(size=14))+
theme(text = element_text(size = 16)) +
ylab("percentage")+ xlab("percieved apple yield change")+
scale_x_discrete(labels=bp_labs)
ggplot(apl, aes(x = as.numeric(apple_yield_change) )) +
geom_bar(aes(y = (..count..)/sum(..count..)), fill=c("grey20", "grey40", "grey60", "grey70", "grey80"))+ theme_bw() +
scale_y_continuous(labels=scales::percent) +
geom_text(aes(label = scales::percent(..prop..), y= ..prop.. ), stat= "count", vjust = -.5, size=6)+
theme(axis.text.x=element_text(size=14))+
theme(text = element_text(size = 16)) +
ylab("percentage")+ xlab("percieved apple yield change")
apl$apple_qual_change
apl[which(apl$apple_qual_change =="decrease"), 4]<-1
apl[which(apl$apple_qual_change =="increase"), 4]<-2
apl[which(apl$apple_qual_change=="no_change"), 4]<-3
apl[which(apl$apple_qual_change=="dont_know"), 4]<-4
apl[which(is.na(apl$apple_qual_change)), 4]<-5
ggplot(bk_data, aes(x = apple_qual_change )) +
geom_bar(aes(y = (..count..)/sum(..count..)), fill="grey70")+ theme_bw() +
scale_y_continuous(labels=scales::percent) +
ylab("percentage")+ xlab("percieved apple quality change")+
geom_text(aes( label = scales::percent(..prop..), y= ..prop.. ), stat= "count", vjust = -.5, size=6)+
theme(axis.text.x=element_text(size=0))+
theme(text = element_text(size = 16))
apl<-read.csv("../data/apple_change.csv", sep=";",check.names=FALSE)
colnames(apl)
apl
apl$apple_yield_change
apl[which(apl$apple_yield_change =="decrease"), 4]<-1
apl[which(apl$apple_yield_change =="increase"), 4]<-2
apl[which(apl$apple_yield_change=="no_change"), 4]<-3
apl[which(apl$apple_yield_change=="dont_know"), 4]<-4
apl[which(is.na(apl$apple_yield_change)), 4]<-5
colnames(apl)
apl[which(apl$apple_qual_change =="decrease"), 6]<-1
apl[which(apl$apple_qual_change =="increase"), 6]<-2
apl[which(apl$apple_qual_change=="no_change"), 6]<-3
apl[which(apl$apple_qual_change=="dont_know"), 6]<-4
apl[which(is.na(apl$apple_qual_change)), 6]<-5
ggplot(bk_data, aes(x = apple_qual_change )) +
geom_bar(aes(y = (..count..)/sum(..count..)), fill="grey70")+ theme_bw() +
scale_y_continuous(labels=scales::percent) +
ylab("percentage")+ xlab("percieved apple quality change")+
geom_text(aes( label = scales::percent(..prop..), y= ..prop.. ), stat= "count", vjust = -.5, size=6)+
theme(axis.text.x=element_text(size=0))+
theme(text = element_text(size = 16))
apl$apple_qual_change
ggplot(bk_data, aes(x = as.numeric(apple_qual_change)) +
geom_bar(aes(y = (..count..)/sum(..count..)), fill="grey70")+ theme_bw() +
scale_y_continuous(labels=scales::percent) +
ylab("percentage")+ xlab("percieved apple quality change")+
geom_text(aes( label = scales::percent(..prop..), y= ..prop.. ), stat= "count", vjust = -.5, size=6)+
theme(axis.text.x=element_text(size=0))+
theme(text = element_text(size = 16))
ggplot(bk_data, aes(x = as.numeric(apple_qual_change))) +
ggplot(bk_data, aes(x = as.numeric(apple_qual_change))) +
geom_bar(aes(y = (..count..)/sum(..count..)), fill="grey70")+ theme_bw() +
scale_y_continuous(labels=scales::percent) +
ylab("percentage")+ xlab("percieved apple quality change")+
geom_text(aes( label = scales::percent(..prop..), y= ..prop.. ), stat= "count", vjust = -.5, size=6)+
theme(axis.text.x=element_text(size=10))+
theme(text = element_text(size = 16))
#### Apple decline question
#apple change
apl<-read.csv("../data/apple_change.csv", sep=";",check.names=FALSE)
colnames(apl)
apl
apl$apple_qual_change
apl[which(apl$apple_qual_change =="decrease"), 6]<-1
apl$apple_qual_change
apl[which(apl$apple_qual_change =="increase"), 6]<-2
apl[which(apl$apple_qual_change=="no_change"), 6]<-3
apl[which(apl$apple_qual_change=="dont_know"), 6]<-4
apl[which(is.na(apl$apple_qual_change)), 6]<-5
ggplot(bk_data, aes(x = as.numeric(apple_qual_change))) +
geom_bar(aes(y = (..count..)/sum(..count..)), fill="grey70")+ theme_bw() +
scale_y_continuous(labels=scales::percent) +
ylab("percentage")+ xlab("percieved apple quality change")+
geom_text(aes( label = scales::percent(..prop..), y= ..prop.. ), stat= "count", vjust = -.5, size=6)+
theme(axis.text.x=element_text(size=10))+
theme(text = element_text(size = 16))
ggplot(apl, aes(x = as.numeric(apple_qual_change))) +
geom_bar(aes(y = (..count..)/sum(..count..)), fill="grey70")+ theme_bw() +
scale_y_continuous(labels=scales::percent) +
ylab("percentage")+ xlab("percieved apple quality change")+
geom_text(aes( label = scales::percent(..prop..), y= ..prop.. ), stat= "count", vjust = -.5, size=6)+
theme(axis.text.x=element_text(size=10))+
theme(text = element_text(size = 16))
ggplot(apl, aes(x = as.numeric(apple_qual_change))) +
geom_bar(aes(y = (..count..)/sum(..count..)), fill="grey70")+ theme_bw() +
scale_y_continuous(labels=scales::percent) +
ylab("percentage")+ xlab("percieved apple quality change")+
geom_text(aes( label = scales::percent(..prop..), y= ..prop.. ), stat= "count", vjust = -.5, size=6)+
theme(axis.text.x=element_text(size=14))+
theme(text = element_text(size = 16))
ggplot(apl, aes(x = as.numeric(apple_qual_change))) +
geom_bar(aes(y = (..count..)/sum(..count..)), fill=c("grey20", "grey40", "grey60", "grey70", "grey80"))+ theme_bw() +
scale_y_continuous(labels=scales::percent) +
ylab("percentage")+ xlab("percieved apple quality change")+
geom_text(aes( label = scales::percent(..prop..), y= ..prop.. ), stat= "count", vjust = -.5, size=6)+
theme(axis.text.x=element_text(size=14))+
theme(text = element_text(size = 16))
ap_qual_plot<-ggplot(apl, aes(x = as.numeric(apple_qual_change))) +
geom_bar(aes(y = (..count..)/sum(..count..)), fill=c("grey20", "grey40", "grey60", "grey70", "grey80"))+ theme_bw() +
scale_y_continuous(labels=scales::percent) +
ylab("percentage")+ xlab("percieved apple quality change")+
geom_text(aes( label = scales::percent(..prop..), y= ..prop.. ), stat= "count", vjust = -.5, size=6)+
theme(axis.text.x=element_text(size=14))+
theme(text = element_text(size = 16))
ap_quan_plot<-ggplot(apl, aes(x = as.numeric(apple_yield_change) )) +
geom_bar(aes(y = (..count..)/sum(..count..)), fill=c("grey20", "grey40", "grey60", "grey70", "grey80"))+ theme_bw() +
scale_y_continuous(labels=scales::percent) +
geom_text(aes(label = scales::percent(..prop..), y= ..prop.. ), stat= "count", vjust = -.5, size=6)+
theme(axis.text.x=element_text(size=14))+
theme(text = element_text(size = 16)) +
ylab("percentage")+ xlab("percieved apple yield change")
Fig_glmm_pol<-ggarrange(ap_quan_plot, ap_qual_plot, widths = c( 6, 6), labels = c("a", "b"), font.label = list(size = 16, color = "black"), ncol = 2)
Fig_apple<-ggarrange(ap_quan_plot, ap_qual_plot, widths = c( 6, 6), labels = c("a", "b"), font.label = list(size = 16, color = "black"), ncol = 2)
annotate_figure(Fig_apple)
ap_quan_plot<-ggplot(apl, aes(x = as.numeric(apple_yield_change) )) +
geom_bar(aes(y = (..count..)/sum(..count..)), fill=c("grey20", "grey40", "grey60", "grey70", "grey80"))+ theme_bw() +
scale_y_continuous(labels=scales::percent) +
geom_text(aes(label = scales::percent(..prop..), y= ..prop.. ), stat= "count", vjust = -.5, size=6)+
theme(axis.text.x=element_text(size=14))+
theme(text = element_text(size = 16)) +
ylab("percentage")+ xlab("percieved apple yield change")
ap_quan_plot
apl<-read.csv("../data/apple_change.csv", sep=";",check.names=FALSE)
colnames(apl)
apl
apl$apple_yield_change
apl[which(apl$apple_yield_change =="decrease"), 4]<-1
apl[which(apl$apple_yield_change =="increase"), 4]<-2
apl[which(apl$apple_yield_change=="no_change"), 4]<-3
apl[which(apl$apple_yield_change=="dont_know"), 4]<-4
apl[which(is.na(apl$apple_yield_change)), 4]<-5
bp_labs<-c('decrease', 'increase', 'no change', 'dont know', "NAs")
ap_quan_plot<-ggplot(apl, aes(x = as.numeric(apple_yield_change) )) +
geom_bar(aes(y = (..count..)/sum(..count..)), fill=c("grey20", "grey40", "grey60", "grey70", "grey80"))+ theme_bw() +
scale_y_continuous(labels=scales::percent) +
geom_text(aes(label = scales::percent(..prop..), y= ..prop.. ), stat= "count", vjust = -.5, size=6)+
theme(axis.text.x=element_text(size=14))+
theme(text = element_text(size = 16)) +
ylab("percentage")+ xlab("percieved apple yield change")
# +
ap_quan_plot
Fig_apple<-ggarrange(ap_quan_plot, ap_qual_plot, widths = c( 6, 6), labels = c("a", "b"), font.label = list(size = 16, color = "black"), ncol = 2)
annotate_figure(Fig_apple)
ap_qual_plot<-ggplot(apl, aes(x = as.numeric(apple_qual_change))) +
geom_bar(aes(y = (..count..)/sum(..count..)), fill=c("grey20", "grey40", "grey60", "grey70", "grey80"))+ theme_bw() +
scale_y_continuous(labels=scales::percent) +
ylab("")+ xlab("percieved apple quality change")+
geom_text(aes( label = scales::percent(..prop..), y= ..prop.. ), stat= "count", vjust = -.5, size=6)+
theme(axis.text.x=element_text(size=14))+
theme(text = element_text(size = 16))
Fig_apple<-ggarrange(ap_quan_plot, ap_qual_plot, widths = c( 6, 6), labels = c("a", "b"), font.label = list(size = 16, color = "black"), ncol = 2)
annotate_figure(Fig_apple)
apl[which(apl$apple_qual_change =="decrease"), 6]<-1
apl[which(apl$apple_qual_change =="increase"), 6]<-2
apl[which(apl$apple_qual_change=="no_change"), 6]<-3
apl[which(apl$apple_qual_change=="dont_know"), 6]<-4
apl[which(is.na(apl$apple_qual_change)), 6]<-5
ap_qual_plot<-ggplot(apl, aes(x = as.numeric(apple_qual_change))) +
geom_bar(aes(y = (..count..)/sum(..count..)), fill=c("grey20", "grey40", "grey60", "grey70", "grey80"))+ theme_bw() +
scale_y_continuous(labels=scales::percent) +
ylab("")+ xlab("percieved apple quality change")+
geom_text(aes( label = scales::percent(..prop..), y= ..prop.. ), stat= "count", vjust = -.5, size=6)+
theme(axis.text.x=element_text(size=14))+
theme(text = element_text(size = 16))
Fig_apple<-ggarrange(ap_quan_plot, ap_qual_plot, widths = c( 6, 6), labels = c("a", "b"), font.label = list(size = 16, color = "black"), ncol = 2)
annotate_figure(Fig_apple)
(apl$apple_qual_change
apl$apple_qual_change
ap_qual_plot<-ggplot(apl, aes(x = as.numeric(apple_qual_change))) +
geom_bar(aes(y = (..count..)/sum(..count..)), fill=c("grey20", "grey40", "grey60", "grey70", "grey80"))+ theme_bw() +
scale_y_continuous(labels=scales::percent) +
ylab("")+ xlab("percieved apple quality change")+
geom_text(aes( label = scales::percent(..prop..), y= ..prop.. ), stat= "count", vjust = -.5, size=6)+
theme(axis.text.x=element_text(size=14))+
theme(text = element_text(size = 16))
ap_qual_plot
Fig_apple<-ggarrange(ap_quan_plot, ap_qual_plot, widths = c( 6, 6), labels = c("a", "b"), font.label = list(size = 16, color = "black"), ncol = 2)
annotate_figure(Fig_apple)
ggsave(paste0(dirF, "Fig_apples.png"),width=8, height =10, units="in", dpi=600 )
ggsave(paste0(dirF, "Fig_apples.png"),width=8, height =8, units="in", dpi=600 )
driF
dirF
#honey yield change data file
hy<-read.csv("../data/honey_yield_change.csv", sep=";",check.names=FALSE)
colnames(hy)
#beehive change
bc<-read.csv("../data/beehive_change.csv", sep=";",check.names=FALSE)
bc
colnames(bc)
colnames(hy)
dim(bc)
bc[, c(7:11)]
hy[, c(5:9)]
bc[, c(7:11)]
hy[, c(5:9)]
bc[, c(7:11)]
bc2<-bc[, c(7:11)]
hy2<-hy[, c(5:9)]
head(bc2)
head(hy2)
bc2*hy2
Tot_hon<-bc2*hy2
tot_hon_t <- pivot_longer(Tot_hon[,],cols = c("2009", "2012", "2017","2019","2021"), names_to = "year")
tot_hon_t
<-bc2*hy2
Tot_hon
head(Tot_hon)
tot_hon_t <- pivot_longer(Tot_hon[,],cols = c(2009, 2012, 2017,2019,2021), names_to = "year")
pivot_longer(Tot_hon[,],cols = c("2009", "2012", "2017","2019","2021"), names_to = "year")
hy
head(hy)
tot_hon_t <- pivot_longer(Tot_hon, names_to = "year")
pivot_longer(Tot_hon[,], names_to = "year")
head(Tot_hon)
hy_t
head(hy)
Tot_hon2<-cbind(hy[,c(1,2)], Tot_hon)
tot_hon_t <- pivot_longer(Tot_hon2[,],cols = c("2009", "2012", "2017","2019","2021"), names_to = "year")
tot_hon_t
mod.lm<-lm(log(value+1) ~ as.numeric(year), data=tot_hon_t)
mod.lm
summary(mod.lm)
tot_hon_plot<- tot_hon_t %>% ggplot(aes(x = as.numeric(year),y = log(value+1))) + geom_jitter(shape=16, position=position_jitter(0.1), alpha=0.3)+
theme_classic()+
stat_compare_means(method = "anova", label.y = 7)+ ylab("total honey yield per beekeeper")+xlab("Year")+
stat_poly_line() +  scale_x_continuous(breaks = scales::pretty_breaks(n = 5))+
geom_label(aes(x = 2018, y = 4.2), hjust = 0, size=5, label = paste("Adj R2 = ",signif(summary(mod.lm)$adj.r.squared, 5)," \nP =",signif(summary(mod.lm)$coef[2,4], 5))) +
geom_smooth(method = "lm", color="black", fill="lightgrey")+
theme(axis.text.y = element_text(size = 14),
axis.title = element_text(size = 14),
axis.text.x = element_text(size = 14),
panel.background = element_rect(colour = "black", size=1))
tot_hon_plot
tot_hon_t
bc2
hy2
#honey yield change data file
hy<-read.csv("../data/honey_yield_change.csv", sep=";",check.names=FALSE)
colnames(hy)
head(hy)
head(bc)
bc
hy
#boxplots and histograms
ggplot(tot_hon_t ) + geom_boxplot(aes(year, value), na.rm = FALSE)#boxplot
ggplot(hy_t, aes(value)) + geom_histogram(binwidth = 0.2)#histogram
ggplot(hy_t, aes(value)) + geom_histogram(binwidth = 0.2)+ scale_x_log10()#hist log scale
ggplot(hy_t, aes(value)) + facet_wrap(~year, scales = 'free_x') + geom_histogram(binwidth = 0.2)+ scale_x_log10()#hist log scale per year
#boxplots and histograms
ggplot(tot_hon_t) + geom_boxplot(aes(year, value), na.rm = FALSE)#boxplot
tot_hon_plot
tot_hon_plot<- tot_hon_t %>% ggplot(aes(x = as.numeric(year),y = log(value+1))) + geom_jitter(shape=16, position=position_jitter(0.1), alpha=0.3)+
theme_classic()+
stat_compare_means(method = "anova", label.y = 7)+ ylab("total honey kg yield per beekeeper")+xlab("Year")+
stat_poly_line() +  scale_x_continuous(breaks = scales::pretty_breaks(n = 5))+
geom_label(aes(x = 2018, y = 6.5), hjust = 0, size=5, label = paste("Adj R2 = ",signif(summary(mod.lm)$adj.r.squared, 5)," \nP =",signif(summary(mod.lm)$coef[2,4], 5))) +
geom_smooth(method = "lm", color="black", fill="lightgrey")+
theme(axis.text.y = element_text(size = 14),
axis.title = element_text(size = 14),
axis.text.x = element_text(size = 14),
panel.background = element_rect(colour = "black", size=1))
tot_hon_plot
tot_hon_plot<- tot_hon_t %>% ggplot(aes(x = as.numeric(year),y = log(value+1))) + geom_jitter(shape=16, position=position_jitter(0.1), alpha=0.3)+
theme_classic()+
stat_compare_means(method = "anova", label.y = 7)+ ylab("total honey kg yield per beekeeper")+xlab("Year")+
stat_poly_line() +  scale_x_continuous(breaks = scales::pretty_breaks(n = 5))+
geom_label(aes(x = 2017, y = 6.5), hjust = 0, size=5, label = paste("Adj R2 = ",signif(summary(mod.lm)$adj.r.squared, 5)," \nP =",signif(summary(mod.lm)$coef[2,4], 5))) +
geom_smooth(method = "lm", color="black", fill="lightgrey")+
theme(axis.text.y = element_text(size = 14),
axis.title = element_text(size = 14),
axis.text.x = element_text(size = 14),
panel.background = element_rect(colour = "black", size=1))
tot_hon_plot
tot_hon_plot<- tot_hon_t %>% ggplot(aes(x = as.numeric(year),y = log(value+1))) + geom_jitter(shape=16, position=position_jitter(0.1), alpha=0.3)+
theme_classic()+
stat_compare_means(method = "anova", label.y = 7)+ ylab("total honey kg yield per beekeeper")+xlab("Year")+
stat_poly_line() +  scale_x_continuous(breaks = scales::pretty_breaks(n = 5))+
geom_label(aes(x = 2017, y = 6.5), hjust = 0, size=3, label = paste("Adj R2 = ",signif(summary(mod.lm)$adj.r.squared, 5)," \nP =",signif(summary(mod.lm)$coef[2,4], 5))) +
geom_smooth(method = "lm", color="black", fill="lightgrey")+
theme(axis.text.y = element_text(size = 14),
axis.title = element_text(size = 14),
axis.text.x = element_text(size = 14),
panel.background = element_rect(colour = "black", size=1))
tot_hon_plot
tot_hon_plot<- tot_hon_t %>% ggplot(aes(x = as.numeric(year),y = log(value+1))) + geom_jitter(shape=16, position=position_jitter(0.1), alpha=0.3)+
theme_classic()+
stat_compare_means(method = "anova", label.y = 7)+ ylab("total honey kg yield per beekeeper")+xlab("Year")+
stat_poly_line() +  scale_x_continuous(breaks = scales::pretty_breaks(n = 5))+
geom_label(aes(x = 2018, y = 6.5), hjust = 0, size=4, label = paste("Adj R2 = ",signif(summary(mod.lm)$adj.r.squared, 5)," \nP =",signif(summary(mod.lm)$coef[2,4], 5))) +
geom_smooth(method = "lm", color="black", fill="lightgrey")+
theme(axis.text.y = element_text(size = 14),
axis.title = element_text(size = 14),
axis.text.x = element_text(size = 14),
panel.background = element_rect(colour = "black", size=1))
tot_hon_plot
tot_hon_plot<- tot_hon_t %>% ggplot(aes(x = as.numeric(year),y = log(value+1))) + geom_jitter(shape=16, position=position_jitter(0.1), alpha=0.3)+
theme_classic()+
stat_compare_means(method = "anova", label.y = 7)+ ylab("total honey kg yield per beekeeper")+xlab("Year")+
stat_poly_line() +  scale_x_continuous(breaks = scales::pretty_breaks(n = 5))+
geom_label(aes(x = 2018, y = 6.5), hjust = 0, size=3, label = paste("Adj R2 = ",signif(summary(mod.lm)$adj.r.squared, 5)," \nP =",signif(summary(mod.lm)$coef[2,4], 5))) +
geom_smooth(method = "lm", color="black", fill="lightgrey")+
theme(axis.text.y = element_text(size = 14),
axis.title = element_text(size = 14),
axis.text.x = element_text(size = 14),
panel.background = element_rect(colour = "black", size=1))
tot_hon_plot
ggsave(paste0(dirF, "tot_honey_decline.png"),width=8, height = 10, units="in", dpi=600 )
